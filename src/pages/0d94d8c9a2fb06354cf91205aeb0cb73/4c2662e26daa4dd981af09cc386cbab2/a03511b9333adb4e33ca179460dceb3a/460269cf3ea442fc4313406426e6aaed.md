---
title: useRequest
size: 8884
---
##### Result

| 参数         | 说明                                                         | 类型                                                         |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| data         | service 返回的数据                                           | `TData` \| `undefined`                                       |
| error        | service 抛出的异常                                           | `Error` \| `undefined`                                       |
| loading      | service 是否正在执行                                         | `boolean`                                                    |
| params       | 当次执行的 service 的参数数组。比如你触发了 `run(1, 2, 3)`，则 params 等于 `[1, 2, 3]` | `TParams`  \| `[]`                                           |
| run          | <ul><li> 手动触发 service 执行，参数会传递给 service</li><li>异常自动处理，通过 `onError` 反馈</li></ul> | `(...params: TParams) => void`                               |
| runAsync     | 与 `run` 用法一致，但返回的是 Promise，需要自行处理异常。    | `(...params: TParams) => Promise<TData>`                     |
| refresh      | 使用上一次的 params，重新调用 `run`                          | `() => void`                                                 |
| refreshAsync | 使用上一次的 params，重新调用 `runAsync`                     | `() => Promise<TData>`                                       |
| mutate       | 直接修改 `data`                                              | `(data?: TData / ((oldData?: TData) => (TData / undefined))) => void` |
| cancel       | 取消当前正在进行的请求                                       | `() => void`                                                 |

##### Options

| 参数          | 说明                                                         | 类型      | 默认值  |
| :------------ | ------------------------------------------------------------ | --------- | ------- |
| manual        | <ul><li> 默认 `false`。 即在初始化时自动执行 service。</li><li>如果设置为 `true`，则需要手动调用 `run` 或 `runAsync` 触发执行。 </li></ul> | `boolean` | `false` |
| defaultParams | 首次默认执行时，传递给 service 的参数                        |           | -       |
| onBefore      | service 执行前触发                                           |           | -       |
| onSuccess     | service resolve 时触发                                       |           | -       |
| onError       | service reject 时触发                                        |           | -       |
| onFinally     | service 执行完成时触发                                       |           | -       |



##### loading延迟展示

| 参数         | 说明                                  | 类型     | 默认值 |
|--------------|---------------------------------------|----------|--------|
| loadingDelay | 设置 `loading` 变成 `true` 的延迟时间 | `number` | `0`    |



##### 轮询

| 参数              | 说明                                                                                                   | 类型      | 默认值 |
|-------------------|--------------------------------------------------------------------------------------------------------|-----------|--------|
| pollingInterval   | 轮询间隔，单位为毫秒。如果值大于 0，则启动轮询模式。                                                   | `number`  | `0`    |
| pollingWhenHidden | 在页面隐藏时，是否继续轮询。如果设置为 false，在页面隐藏时会暂时停止轮询，页面重新显示时继续上次轮询。 | `boolean` | `true` |



##### ready

| 参数  | 说明                 | 类型      | 默认值 |
|-------|----------------------|-----------|--------|
| ready | 当前请求是否准备好了 | `boolean` | `true` |

- 当 `manual=false` 自动请求模式时，每次 `ready` 从 `false` 变为 `true` 时，都会自动发起请求，会带上参数 `options.defaultParams`。
- 当 `manual=true` 手动请求模式时，只要 `ready=false`，则通过 `run/runAsync` 触发的请求都不会执行



##### 依赖刷新

| 参数        | 说明                                                              | 类型    | 默认值 |
|-------------|-------------------------------------------------------------------|---------|--------|
| refreshDeps | 依赖数组，当数组内容变化后，发起请求。同 `useEffect` 的第二个参数。 | `any[]` | `[]`   |



##### 防抖

| 参数             | 说明                                     | 类型      | 默认值  |
|------------------|-----------------------------------------|-----------|---------|
| debounceWait     | 防抖等待时间, 单位为毫秒，设置后，进入防抖模式 | `number`  | -       |
| debounceLeading  | 在延迟开始前执行调用                       | `boolean` | `false` |
| debounceTrailing | 在延迟结束后执行调用                       | `boolean` | `true`  |
| debounceMaxWait  | 允许被延迟的最大值                         | `number`  | -       |



##### 节流

| 参数             | 说明                                           | 类型      | 默认值 |
|------------------|------------------------------------------------|-----------|--------|
| throttleWait     | 节流等待时间, 单位为毫秒，设置后，进入节流模式 | `number`  | -      |
| throttleLeading  | 在节流开始前执行调用                               | `boolean` | `true` |
| throttleTrailing | 在节流结束后执行调用                               | `boolean` | `true` |



##### 缓存 & SWR

| 参数      | 说明                                                                                                                                                                          | 类型                              | 默认值   |
|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|----------|
| cacheKey  | 请求唯一标识。如果设置了 `cacheKey`，我们会启用缓存机制。同一个 `cacheKey` 的数据全局同步。                                                                                   | `string`                          | `[]`     |
| cacheTime | <ul><li> 设置缓存数据回收时间。默认缓存数据 5 分钟后回收 </li><li> 如果设置为 `-1`, 则表示缓存数据永不过期</li></ul>                                                          | `number`                          | `300000` |
| staleTime | <ul><li> 缓存数据保持新鲜时间。在该时间间隔内，认为数据是新鲜的，不会重新发请求 </li><li> 如果设置为 `-1`，则表示数据永远新鲜</li></ul>                                       | `number`                          | `0`      |
| setCache  | <ul><li> 自定义设置缓存 </li><li> `setCache` 和 `getCache` 需要配套使用</li><li> 在自定义缓存模式下，`cacheTime` 和 `clearCache` 不会生效，请根据实际情况自行实现。</li></ul> | `(data: CachedData) => void;`     | -        |
| getCache  | 自定义读取缓存                                                                                                                                                                | `(params: TParams) => CachedData` | -        |



##### 错误重试

| 参数          | 说明                                                                                                                                                                                                 | 类型     | 默认值 |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|--------|
| retryCount    | 错误重试次数。如果设置为 `-1`，则无限次重试。                                                                                                                                                        | `number` | -      |
| retryInterval | <ul><li>重试时间间隔，单位为毫秒。</li><li>如果不设置，默认采用简易的指数退避算法，取 `1000 * 2 ** retryCount`，也就是第一次重试等待 2s，第二次重试等待 4s，以此类推，如果大于 30s，则取 30s </li></ul> | `number` | -      |



ref:

https://ahooks.gitee.io/zh-CN/hooks/use-request/basic#result
