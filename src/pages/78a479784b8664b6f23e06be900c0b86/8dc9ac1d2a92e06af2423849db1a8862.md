---
title: tips
size: 1814
---
复杂对象调试展示
https://react.formilyjs.org/zh-CN/api/hooks/use-field#%E7%94%A8%E4%BE%8B
```jsx
<code>
	<pre>
		<FormConsumer>
			{(form) => JSON.stringify(form.values, null, 2)}
		</FormConsumer>
	</pre>
</code>
```

获取value
```js
form.query('xxxx').value()
```

select异步搜索
https://antd5.formilyjs.org/zh-CN/components/select#markup-schema-%E5%BC%82%E6%AD%A5%E6%90%9C%E7%B4%A2%E6%A1%88%E4%BE%8B
```js
const useAsyncDataSource = (
  pattern,
  service
) => {
  const keyword = observable.ref('')

  // 添加search动态监听
  onFieldInit(pattern, (field) => {
    field.setComponentProps({
      onSearch: (value: string) => {
        keyword.value = value
      },
    })
  })

  // keyword发生变化，执行请求逻辑
  onFieldReact(pattern, (field: Field) => {
    field.loading = true
    service({ field, keyword: keyword.value }).then(
      action.bound?.((data) => {
        field.dataSource = data
        field.loading = false
      })
    )
  })
}
```

手动更新value
```js
form.setFieldState('xxxx', (state) => {
	state.setValue([
		{
			xxxx,
		}
	])
})
```

手动更新组件props
```js
field.setComponentProps({
	...
})
```

手动更新装饰器props
```js
field.setDecoratorProps({
	...
})
```

手动更新value
```js
field.setValue(...)
```

field值变化时，更新其他field
```js
createForm({
    ...
    effects() {
        onFieldValueChange('attr', (field) => {
            // 取出对应目标
            const target = form.query('attr').take()

            target.setDecoratorProps(..)
        })
    }
})
```

删除数据
```js
form.deleteValuesIn('xxx')
```

refs:
- 经验汇总
	- https://fishedee.com/2021/07/14/Formily%E7%9A%84core%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%B1%87%E6%80%BB/
- 校验
	- https://formilyjs.org/zh-CN/guide/advanced/validate
