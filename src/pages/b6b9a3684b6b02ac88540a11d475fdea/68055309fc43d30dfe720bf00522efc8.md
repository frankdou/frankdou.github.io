---
title: gulp
date: 2022-04-14T12:00:22.542Z
size: 844
---
less、ts编译

```
const { watch } = require('gulp')
const chalk = require('chalk')
const exec = require('child_process').exec

exports.default = () => {
  // less compile
  watch(['./**/*.less', '!node_modules/**/*.less']).on('change', (path) => {
    const command = `npx lessc ${path} ${path.replace('less', 'wxss')}`

    exec(command, (err, stdout, stderr) => {
      if (err) {
        console.log(err, 'less compile error')
      } else {
        console.log(`${path} 编译完成`);
      }
    })
  })

  // ts compile
  exec('tsc -w').stdout.on('data', function (data) {    
    let color = 'bgGreen'

    // error
    if (data.includes('error TS')) {
      color = 'bgRedBright'
    }

    // total
    if (data.includes('Watching for file changes')) {
      color = 'bgCyan'
    }

    console.log(chalk[color](data))
  })
}
```

