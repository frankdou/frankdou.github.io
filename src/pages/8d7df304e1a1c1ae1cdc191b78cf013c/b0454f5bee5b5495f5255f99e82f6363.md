---
title: 进程、线程
date: 2022-04-14T12:00:22.520Z
size: 1915
---
##### 单核CPU（工厂）

- 单个进程（电力有限，一次只能供给一个车间使用，其他车间都必须停工）
  - 多线程（很多工人，协同完成一个任务）
    - 线程是操作系统能够进行运算调度的最小单位
    - 一个线程只能隶属于一个进程

- 以多进程形式，允许多个任务同时运行
- 以多线程形式，允许单个任务分成不同的部分运行
- 提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源
- 每个进程都拥有自己的独立空间，一个进程无法访问另外一个进程里定义的变量、数据结构，只有建立了 IPC 通信，进程之间才可数据共享



##### IPC 通信

- IPC的全称是Inter-Process Communication，即进程间通信
- Node中实现IPC通道是依赖于libuv
- windows下由命名管道(name pipe)实现
- unix系统则采用Unix Domain Socket实现



##### Node是单线程?

- 指的是 JavaScript 的执行是单线程的
- Javascript 的宿主环境，无论是 Node 还是浏览器都是多线程的
- libuv会通过类似线程池的实现来模拟不同操作系统的异步调用，这对开发者来说是不可见的

###### 查看8080端口服务信息，查看该服务进程的pid

```shell
lsof -i tcp:8080

pgrep -l node
```

###### 查看进程详细信息，`#TH` 为threads线程数

```shell
top -pid 36787
```



##### 通常一个Node进程包含哪些线程

- 1个执行主线程
- 1个监控线程用于处理调试信息
- 1个 v8task scheduler线程用于调度任务优先级，加速延迟敏感任务执行
- 4个 v8线程，主要用来执行代码调优、GC等后台任务

###### cluster模块

进程管理、负载均衡以及实现端口复用

###### worker_threads

为了减小 CPU 密集型任务计算的系统开销，引入了新的特性工作线程 
