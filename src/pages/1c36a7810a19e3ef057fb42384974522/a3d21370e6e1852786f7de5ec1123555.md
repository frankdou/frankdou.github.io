---
title: 命令记录
size: 2649
---
#### 代码合并(提交记录合并为1个)

##### squash

- 切换至目标分支
- git merge --squash 要合并的分支名
- commit

##### rebase

- git rebase -i commitId（被合并的commit之前的一个id）
  - git rebase -i --root（合并项目的第一个commit）
  - https://stackoverflow.com/questions/2246208/change-first-commit-of-project-with-git

- 修改commit提交记录为fixup、squash等
- 解决冲突
- 代码提交



#### 其他

##### reflog

所有的git变动记录查找（包括被删的commit）https://w3c.hexschool.com/git/10bf7677

```shell
git reflog
git reset 4e79205 --hard
```
##### stash

```shell
// 保存
git stash push -m "say-my-name"
// 应用
git stash apply stash@{0}
```

##### 删除所有本地修改
```shell
git reset --hard
```
##### 删除所有本地添加的文件，文件夹
```shell
git clean -f
```

##### 跨仓库进行cherry-pick
```shell
git remote add xxx https://example.link/repository.git
git fetch xxx

git cherry-pick xxxxx
```

##### 关键字检索

```shell
git grep xxx
```

##### 删除本地所有ignore的文件

```shell
git clean -dfX
```

##### 删除本地ignore的文件，除了特定文件

```shell
git clean -dfx --exclude=node_modules
git clean -dfx --exclude=node_modules --exclude=src
```

##### 只clone部分文件夹
```shell
git clone --depth=1 --filter=blob:none --no-checkout https://github.com/grpc/grpc.git

cd grpc

git sparse-checkout init --cone

echo "examples/node/*" >> .git/info/sparse-checkout

git checkout
```
-   `--depth=1`: 只克隆最新的一次提交和相关的文件，不克隆历史记录
-   `--no-checkout`: 在克隆时不执行 checkout 操作。
-   `git sparse-checkout init --cone`：初始化 sparse checkout 模式（稀疏检出）。
-   `echo "examples/node/*" >> .git/info/sparse-checkout`：将需要下载的目录添加到配置文件里面。
-   `git checkout`: 执行 checkout 命令使我们指定的文件夹下载到本地。
https://unix.stackexchange.com/questions/233327/is-it-possible-to-clone-only-part-of-a-git-project
##### 加速下载，只下载最新的版本
```
git clone --depth 1 https://github.com/facebook/react
```
##### 撤回特定commit的特定文件
https://stackoverflow.com/questions/215718/how-do-i-reset-or-revert-a-file-to-a-specific-revision
#### 新项目初始化

```shell
git clone git@xxx.git 项目文件夹
cd 项目文件夹 && rm -rf .git 
git init
git remote add origin 新项目git地址
git checkout -b preview
git add .
git commit -m 'init'
```


refs:

cheatsheet：https://cheatsheeets.netlify.app/git

git-tips：https://github.com/521xueweihan/git-tips

